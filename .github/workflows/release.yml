name: Create Release and Upload JAR

on:
  push:
    branches:
      - release

jobs:
  create_release:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Java and Maven
      uses: actions/setup-java@v2
      with:
        distribution: 'adopt'
        java-version: '17'  # Ustaw wersję Java zgodnie z Twoimi wymaganiami

    - name: Create Download directory
      run: mkdir -p /home/runner/Downloads

    - name: Build project
      run: mvn clean install

    - name: Set up GitHub CLI
      run: |
        echo "GH_TOKEN=${{ secrets.GITHUB_TOKEN }}" >> $GITHUB_ENV
        gh --version  # Sprawdź, czy GitHub CLI jest dostępne w PATH

    - name: Create Release
      id: create_release
      run: |
        RELEASE_NAME="v$(date +'%Y_%m_%d_%H_%M_%S')"
        echo "RELEASE_NAME=$RELEASE_NAME" >> $GITHUB_ENV
        gh release create $RELEASE_NAME target/*.jar -t "$RELEASE_NAME" -n "Release $RELEASE_NAME"
        

